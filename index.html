<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç·šä¸Šå®…é…å¡«å¯«å–® (ä¸²æ¥Google Sheets)</title>
    <style>
        /* CSS æ¨£å¼èˆ‡ä¹‹å‰ç›¸åŒ */
        body { font-family: "Microsoft JhengHei", Arial, sans-serif; background-color: #f4f7f6; color: #333; line-height: 1.6; padding: 20px; }
        .form-container { max-width: 800px; margin: 0 auto; background: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-bottom: 20px; }
        fieldset { border: 1px solid #ddd; border-radius: 5px; padding: 20px; margin-bottom: 20px; background-color: #fafafa; }
        legend { font-weight: bold; color: #3498db; background: #fff; padding: 0 10px; border: 1px solid #ddd; border-radius: 3px; }
        .form-group { display: flex; flex-wrap: wrap; margin-bottom: 15px; }
        .form-group label { flex: 1 0 120px; font-weight: bold; margin-bottom: 5px; display: flex; align-items: center; }
        .form-group .input-wrapper { flex: 3 0 200px; }
        input[type="text"], input[type="tel"], input[type="date"], select, textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 16px; }
        textarea { resize: vertical; height: 80px; }
        .required { color: #e74c3c; margin-left: 3px; }
        .submit-btn { display: block; width: 100%; padding: 15px; background-color: #3498db; color: white; border: none; border-radius: 4px; font-size: 18px; font-weight: bold; cursor: pointer; transition: background-color 0.3s; }
        .submit-btn:hover { background-color: #2980b9; }
        .submit-btn:disabled { background-color: #95a5a6; cursor: not-allowed; }
        @media (max-width: 600px) { .form-group { flex-direction: column; } .form-group label { margin-bottom: 8px; } }
    </style>
</head>
<body>

<div class="form-container">
    <h2>ğŸ“¦ ç·šä¸Šè¨—é‹å¡«å¯«å–®</h2>
    
    <form id="deliveryForm">
        
        <fieldset>
            <legend>å¯„ä»¶äººè³‡è¨Š</legend>
            <div class="form-group">
                <label>å§“å/å…¬å¸<span class="required">*</span></label>
                <div class="input-wrapper"><input type="text" name="senderName" required></div>
            </div>
            <div class="form-group">
                <label>è¯çµ¡é›»è©±<span class="required">*</span></label>
                <div class="input-wrapper"><input type="tel" name="senderPhone" required></div>
            </div>
        </fieldset>

        <fieldset>
            <legend>æ”¶ä»¶äººè³‡è¨Š</legend>
            <div class="form-group">
                <label>å§“å/å…¬å¸<span class="required">*</span></label>
                <div class="input-wrapper"><input type="text" name="receiverName" required></div>
            </div>
            <div class="form-group">
                <label>è¯çµ¡é›»è©±<span class="required">*</span></label>
                <div class="input-wrapper"><input type="tel" name="receiverPhone" required></div>
            </div>
            <div class="form-group">
                <label>å®Œæ•´åœ°å€<span class="required">*</span></label>
                <div class="input-wrapper"><input type="text" name="receiverAddress" required></div>
            </div>
        </fieldset>

        <fieldset>
            <legend>åŒ…è£¹èˆ‡é…é€è¨­å®š</legend>
            <div class="form-group">
                <label>å¸Œæœ›é…é”æ—¥<span class="required">*</span></label>
                <div class="input-wrapper">
                    <select name="deliveryTime">
                        <option value="å¹³æ—¥">å¹³æ—¥</option>
                        <option value="ä¸é™">ä¸é™</option>
                    </select>
                </div>
           </div>
           <div class="form-group">
                <label>æ•¸é‡é¸æ“‡<span class="required">*</span></label>
                <div class="input-wrapper">
                    <select name="weight">
                        <option value="10æ–¤">10æ–¤</option>
                        <option value="20æ–¤">20æ–¤</option>
                        <option value="2ç®±10æ–¤">2ç®±10æ–¤</option>
                    </select>
            </div>
            <div class="form-group">
                <label>æ•¸é‡<span class="required">*</span></label>
                <div class="input-wrapper"><input type="text" name="number" required></div>
            </div>
                <div class="form-group">
                <label>å¸Œæœ›æ™‚æ®µ<span class="required">*</span></label>
                <div class="input-wrapper">
                    <select name="deliveryTime">
                        <option value="ä¸æŒ‡å®š">ä¸æŒ‡å®š</option>
                        <option value="13:00å‰">13:00 å‰</option>
                        <option value="14:00-18:00">14:00 - 18:00</option>
                    </select>
            </div>          
            <div class="form-group">
                <label>ç‰¹æ®Šå‚™è¨»</label>
                <div class="input-wrapper"><textarea name="notes"></textarea></div>
            </div>
        </fieldset>

        <button type="submit" class="submit-btn" id="submitBtn">é€å‡ºè¨—é‹å–®</button>
    </form>
</div>

<script>
    // è«‹å°‡ä¸‹æ–¹çš„ URL æ›æˆæ‚¨åœ¨ Google Apps Script éƒ¨ç½²å¾Œå–å¾—çš„ Web App URL
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzEIW3bTjSTXW4UtIAXMSkgxkVVX_VgKPZU14vsRi_-ss557ktnVjU3ZcytMzHybJ6L/exec'; 
    const form = document.getElementById('deliveryForm');
    const submitBtn = document.getElementById('submitBtn');

    form.addEventListener('submit', e => {
        e.preventDefault(); // é˜²æ­¢é é¢é‡æ–°è¼‰å…¥
        
        // æ”¹è®ŠæŒ‰éˆ•ç‹€æ…‹ï¼Œæç¤ºä½¿ç”¨è€…æ­£åœ¨è™•ç†ä¸­
        submitBtn.disabled = true;
        submitBtn.textContent = 'è³‡æ–™å‚³é€ä¸­...';

        // ä½¿ç”¨ FormData æ”¶é›†è¡¨å–®è³‡æ–™
        let formData = new FormData(form);

        // å°‡è³‡æ–™ POST åˆ° Google Apps Script
        fetch(scriptURL, { method: 'POST', body: formData})
            .then(response => {
                alert('âœ… è¨—é‹å–®å·²æˆåŠŸé€å‡ºï¼');
                form.reset(); // æ¸…ç©ºè¡¨å–®
                submitBtn.disabled = false;
                submitBtn.textContent = 'é€å‡ºè¨—é‹å–®';
            })
            .catch(error => {
                console.error('Error!', error.message);
                alert('âŒ å‚³é€å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦æˆ–è¯ç¹«å®¢æœã€‚');
                submitBtn.disabled = false;
                submitBtn.textContent = 'é€å‡ºè¨—é‹å–®';
            });
    });
</script>

</body>
</html>